%
%   Simulation of the train
%   Copyright Hamid D. Taghirad 2013
%
clear all
clf; echo off
%   State variable 
% x=
% [dx2   dx3 dx4 dx5 dv1    dv2  dv3  dv4   dv5   z];
A=[0      0   0   0   1     -1    0    0     0    0
   0      0   0   0   0      1   -1    0     0    0
   0      0   0   0   0      0    1   -1     0    0
   0      0   0   0   0      0    0    1    -1    0
  -12.5   0   0   0 -0.75  0.75   0    0     0    0
   62.5 -62.5 0   0  3.75  -7.5  3.75  0     0    0
   0  62.5 -62.5  0   0    3.75  -7.5  3.75  0    0
   0   0  62.5 -62.5  0      0   3.75  -7.5  3.75 0   
   0   0   0    62.5  0      0     0   3.75 -3.75 0
   0   0   0      0   0      0     0      0   0  -1/40
   ];
B=[0;  0;  0;  0;  0.005;  0;  0;  0;  0;  0];     % Force input
Q=diag([3.34^2,3.34^2,3.34^2,3.34^2, ...
    3^2+0.5^2,2*3^2,2*3^2, 2*3^2, 3^2, 0.5^2]);
Q(6,5)=-9; Q(5,6)=-9; Q(7,6)=-9; Q(6,7)=-9; 
Q(8,7)=-9; Q(7,8)=-9; Q(9,8)=-9; Q(8,9)=-9;
Q(10,5)=0.5^2; Q(5,10)=0.5^2; 
R=1/120^2;
k=lqr(A,B,Q,R);
R1=35*R;
k1=lqr(A,B,Q,R1)


