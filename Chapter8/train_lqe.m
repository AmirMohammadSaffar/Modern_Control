%
%   Design of the train LQ Observer
%   Copyright Hamid D. Taghirad 2014
%
clear all
clf; echo off
%   State variable 
% x=
% [dx2   dx3 dx4 dx5 dv1    dv2  dv3  dv4   dv5];
A=[0      0   0   0   1     -1    0    0     0
   0      0   0   0   0      1   -1    0     0
   0      0   0   0   0      0    1   -1     0
   0      0   0   0   0      0    0    1    -1
  -12.5   0   0   0 -0.75  0.75   0    0     0
   62.5 -62.5 0   0  3.75  -7.5  3.75  0     0
   0  62.5 -62.5  0   0    3.75  -7.5  3.75  0
   0   0  62.5 -62.5  0      0   3.75  -7.5  3.75    
   0   0   0    62.5  0      0     0   3.75 -3.75 
   ];
C= [1 0 0 0 0 0 0 0 0;
    0 0 0 0 1 0 0 0 0];
O=obsv(A,C); rank(O)
W=diag([0 0 0 0 9 0 0 0 0]);
V=diag([1e-2,1]);
G=lqr(A',C',W,V)'
% The result is:
G =[
10.5008 4.0624 1.2245 0.3222  118.1098 60.1867 16.7939 -0.0227 -4.2587
 0.0472 0.0100 0.0004 -0.0007 1.1441    0.5240  0.3003  0.2370  0.2213];
   
    


